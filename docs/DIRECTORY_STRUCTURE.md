# ODAS Directory Structure

This document describes the organization of the ODAS project with Windows build support.

## Top-Level Structure

```
odas/
├── build-scripts/          # Build scripts and toolchain files
├── docs/                   # Documentation
├── config/                 # Configuration files for ODAS
├── src/                    # ODAS source code
├── include/                # ODAS header files
├── demo/                   # Demo applications
├── build-mingw/            # Windows build output (auto-generated)
├── build/                  # Linux build output (auto-generated)
├── CMakeLists.txt          # Main CMake configuration
└── README.md               # Project overview
```

## Build Scripts (`build-scripts/`)

Contains all build-related scripts and toolchain files:

```
build-scripts/
├── build_mingw.sh          # Main Windows build script (MinGW cross-compilation)
├── toolchain-mingw.cmake   # CMake toolchain file for MinGW-w64
├── build_fftw_mingw.sh     # FFTW dependency build script (if needed)
└── build_windows.sh        # Alternative Windows build script
```

**Usage:**
```bash
# Build for Windows
./build-scripts/build_mingw.sh

# Clean build
./build-scripts/build_mingw.sh --clean

# Rebuild dependencies
./build-scripts/build_mingw.sh --rebuild-deps
```

## Documentation (`docs/`)

Contains all Windows-specific documentation:

```
docs/
├── README.md               # Documentation overview and quick links
├── QUICKSTART_WINDOWS.md   # Quick start guide for Windows builds
├── BUILD_WINDOWS.md        # Detailed Windows build instructions
├── CLEANUP.md              # Guide for cleaning up old build artifacts
└── DIRECTORY_STRUCTURE.md  # This file
```

**Reading Order:**
1. Start with `README.md` for an overview
2. Read `QUICKSTART_WINDOWS.md` for quick start
3. Consult `BUILD_WINDOWS.md` for detailed information
4. Use `CLEANUP.md` to clean up old build artifacts

## Build Output (`build-mingw/`)

Auto-generated by `build-scripts/build_mingw.sh`:

```
build-mingw/
├── bin/                    # Compiled executables and DLLs
│   ├── libodas.dll         # Main ODAS library with WASAPI
│   ├── odaslive.exe        # Real-time audio processing app
│   ├── odasserver.exe      # Server application
│   ├── libconfig.dll       # Configuration library
│   └── libwinpthread-1.dll # POSIX threads for Windows
├── deps/                   # Built dependencies (libconfig, etc.)
├── libodas.def             # DLL export definitions
├── libodas_fixed.dll.a     # Import library for linking
└── CMakeCache.txt          # CMake configuration cache
```

**Note:** This directory is created automatically during the build process. You can clean it with:
```bash
./build-scripts/build_mingw.sh --clean
```

## Configuration Files (`config/`)

Contains ODAS configuration files:

```
config/
├── odaslive/
│   ├── tetrahedral_4ch-b.cfg   # Teensy 4-channel tetrahedral array config
│   └── ...                     # Other configurations
└── ...
```

**Example Configuration:**
```cfg
raw: {
    fS = 44100;
    hopSize = 512;
    nBits = 16;
    nChannels = 4;

    interface: {
        type = "wasapi";           # Windows WASAPI interface
        devicename = "Teensy Audio"; # Audio device name
    }
}
```

## Source Code

```
src/                        # ODAS C source files
include/odas/               # ODAS public headers
demo/                       # Demo applications
```

## Git Ignored Files

The following are ignored by `.gitignore`:

- `build/` - Linux build output
- `build-mingw/` - Windows build output
- `build-windows*/` - Old build directories
- `fftw-mingw-build/` - Old FFTW build
- `windows-deps/` - Old dependency directory
- `bin/`, `lib/` - Build artifacts
- `*.raw` - Raw audio files

## Migration from Old Structure

If you have old build directories, see [CLEANUP.md](CLEANUP.md) for cleanup instructions.

**Old structure (deprecated):**
```
odas/
├── build_mingw.sh              # Now in build-scripts/
├── toolchain-mingw.cmake       # Now in build-scripts/
├── BUILD_WINDOWS.md            # Now in docs/
├── QUICKSTART_WINDOWS.md       # Now in docs/
├── build-windows/              # Deprecated, can be removed
├── build-windows-simple/       # Deprecated, can be removed
├── fftw-mingw-build/           # Deprecated, can be removed
└── windows-deps/               # Deprecated, can be removed
```

**New structure (current):**
```
odas/
├── build-scripts/              # Build scripts (organized)
├── docs/                       # Documentation (organized)
├── build-mingw/                # Active Windows build output
└── [source files...]
```

## Quick Reference

| Task | Command |
|------|---------|
| Build for Windows | `./build-scripts/build_mingw.sh` |
| Clean build | `./build-scripts/build_mingw.sh --clean` |
| Run odaslive | `build-mingw/bin/odaslive.exe -c config/odaslive/tetrahedral_4ch-b.cfg` |
| View docs | `docs/README.md` |
| Clean old files | See `docs/CLEANUP.md` |

## Platform Support

- **Windows**: Full support with WASAPI audio (build with MinGW cross-compilation)
- **Linux**: Full support (build with standard CMake)
- **macOS**: Supported by upstream ODAS (not tested in this fork)

## Getting Started

1. Read [docs/README.md](README.md)
2. Build: `./build-scripts/build_mingw.sh`
3. Configure: Edit `config/odaslive/tetrahedral_4ch-b.cfg`
4. Run: `build-mingw/bin/odaslive.exe -c config/odaslive/tetrahedral_4ch-b.cfg -v`
